generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model mt_tags {
  id                 Int                  @id @default(autoincrement())
  name               String               @unique @db.VarChar(255)
  created_at         DateTime             @default(now()) @db.Timestamp(6)
  updated_at         DateTime             @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted         Boolean              @default(false)
  mt_user_tags       mt_user_tags[]
  tt_test_group_tags tt_test_group_tags[]
}

model mt_user_tags {
  user_id  Int
  tag_id   Int
  mt_tags  mt_tags  @relation(fields: [tag_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  mt_users mt_users @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  created_at              DateTime                @default(now()) @db.Timestamp(6)
  updated_at              DateTime                @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted              Boolean                 @default(false)

  @@id([user_id, tag_id])
}

model mt_users {
  id           Int            @id @default(autoincrement())
  email        String         @unique @db.VarChar(255)
  name         String         @db.VarChar(255)
  user_role    Int            @default(2)
  department   String         
  company      String         @db.VarChar(255)
  password     String         @db.VarChar(255)
  created_at   DateTime       @default(now()) @db.Timestamp(6)
  updated_at   DateTime       @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted   Boolean        @default(false)
  mt_user_tags mt_user_tags[]

  @@index([email], map: "idx_users_email")
  @@index([user_role], map: "idx_users_role")
}


model tt_import_results {
  id                      Int                       @id @default(autoincrement())
  file_name               String?                   
  import_status           Int?                      @default(1)
  executor_name           String?                   @db.VarChar(255)
  import_type             Int?
  count                   Int?                      @default(0)
  message                 String?                                      
  created_at              DateTime                  @default(now()) @db.Timestamp(6)
  updated_at              DateTime                  @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted              Boolean                   @default(false)
  @@index([import_status], map: "idx_import_results_status")
}

model tt_test_case_files {
  test_group_id Int
  tid           String        @db.VarChar(255)
  file_type     Int
  file_no       Int
  file_name     String?
  file_path     String?
  created_at    DateTime      @default(now()) @db.Timestamp(6)
  updated_at    DateTime      @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted    Boolean       @default(false)
  tt_test_cases tt_test_cases @relation(fields: [test_group_id, tid], references: [test_group_id, tid], onDelete: Cascade, onUpdate: NoAction)

  @@id([test_group_id, tid, file_type, file_no])
}

model tt_test_cases {
  test_group_id      Int
  tid                String               @db.VarChar(255)
  first_layer        String
  second_layer       String
  third_layer        String
  fourth_layer       String
  purpose            String
  request_id         String
  check_items        String
  test_procedure     String
  created_at         DateTime             @default(now()) @db.Timestamp(6)
  updated_at         DateTime             @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted         Boolean              @default(false)
  tt_test_case_files tt_test_case_files[]
  tt_test_groups     tt_test_groups       @relation(fields: [test_group_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tt_test_contents   tt_test_contents[]

  @@id([test_group_id, tid])
  @@index([test_group_id], map: "idx_test_cases_group")
}

model tt_test_contents {
  test_group_id           Int
  tid                     String                    @db.VarChar(255)
  test_case_no            Int
  test_case               String?
  expected_value          String?
  is_target               Boolean                   @default(true)
  created_at              DateTime                  @default(now()) @db.Timestamp(6)
  updated_at              DateTime                  @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted              Boolean                   @default(false)
  tt_test_cases           tt_test_cases             @relation(fields: [test_group_id, tid], references: [test_group_id, tid], onDelete: Cascade, onUpdate: NoAction)
  tt_test_results         tt_test_results?
  tt_test_results_history tt_test_results_history[]

  @@id([test_group_id, tid, test_case_no])
  @@index([is_target], map: "idx_test_contents_target")
}

model tt_test_evidences {
  test_group_id           Int
  tid                     String                  @db.VarChar(255)
  test_case_no            Int
  history_count           Int
  evidence_no             Int
  evidence_name           String?
  evidence_path           String?
  created_at              DateTime                @default(now()) @db.Timestamp(6)
  updated_at              DateTime                @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted              Boolean                 @default(false)
  tt_test_results_history tt_test_results_history @relation(fields: [test_group_id, tid, test_case_no, history_count], references: [test_group_id, tid, test_case_no, history_count], onDelete: Cascade, onUpdate: NoAction)

  @@id([test_group_id, tid, test_case_no, history_count, evidence_no])
}

model tt_test_group_tags {
  test_group_id  Int
  tag_id         Int
  test_role      Int
  mt_tags        mt_tags        @relation(fields: [tag_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  created_at              DateTime                @default(now()) @db.Timestamp(6)
  updated_at              DateTime                @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted              Boolean                 @default(false)
  tt_test_groups tt_test_groups @relation(fields: [test_group_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([test_group_id, tag_id, test_role])
  @@index([test_group_id], map: "idx_test_group_tags_group")
  @@index([tag_id], map: "idx_test_group_tags_tag")
}

model tt_test_groups {
  id                 Int                  @id @default(autoincrement())
  oem                String?              @db.VarChar(255)
  model              String?              @db.VarChar(255)
  event              String?              @db.VarChar(255)
  variation          String?              @db.VarChar(255)
  destination        String?              @db.VarChar(255)
  specs              String?
  test_startdate     DateTime?            @db.Date
  test_enddate       DateTime?            @db.Date
  ng_plan_count      Int?                 @default(0)
  created_by         Int?
  updated_by         Int?
  created_at         DateTime             @default(now()) @db.Timestamp(6)
  updated_at         DateTime             @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted         Boolean              @default(false)
  tt_test_cases      tt_test_cases[]
  tt_test_group_tags tt_test_group_tags[]

  @@index([created_by], map: "idx_test_groups_created_by")
}

model tt_test_results {
  test_group_id      Int
  tid                String           @db.VarChar(255)
  test_case_no       Int
  result             String?
  judgment           String?          @db.VarChar(16)
  software_version   String?          @db.VarChar(255)
  hardware_version   String?          @db.VarChar(255)
  comparator_version String?          @db.VarChar(255)
  execution_date     DateTime?        @db.Date
  executor           String?          @db.VarChar(255)
  note               String?
  version            Int              @default(1)
  created_at         DateTime         @default(now()) @db.Timestamp(6)
  updated_at         DateTime         @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted         Boolean          @default(false)
  tt_test_contents   tt_test_contents @relation(fields: [test_group_id, tid, test_case_no], references: [test_group_id, tid, test_case_no], onDelete: Cascade, onUpdate: NoAction)

  @@id([test_group_id, tid, test_case_no])
  @@index([judgment], map: "idx_test_results_judgment")
}

model tt_test_results_history {
  test_group_id      Int
  tid                String              @db.VarChar(255)
  test_case_no       Int
  history_count      Int
  result             String?
  judgment           String?             @db.VarChar(16)
  software_version   String?             @db.VarChar(255)
  hardware_version   String?             @db.VarChar(255)
  comparator_version String?             @db.VarChar(255)
  execution_date     DateTime?           @db.Date
  executor           String?             @db.VarChar(255)
  note               String?
  version            Int                 @default(1)
  created_at         DateTime            @default(now()) @db.Timestamp(6)
  updated_at         DateTime            @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted         Boolean             @default(false)
  tt_test_evidences  tt_test_evidences[]
  tt_test_contents   tt_test_contents    @relation(fields: [test_group_id, tid, test_case_no], references: [test_group_id, tid, test_case_no], onDelete: Cascade, onUpdate: NoAction)

  @@id([test_group_id, tid, test_case_no, history_count])
}