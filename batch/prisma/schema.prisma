generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model mt_tags {
  id                 Int                  @id @default(autoincrement())
  name               String               @unique @db.VarChar(255)
  created_at         DateTime             @default(now()) @db.Timestamp(6)
  updated_at         DateTime             @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted         Boolean              @default(false)
  mt_user_tags       mt_user_tags[]
  tt_test_group_tags tt_test_group_tags[]
}

model mt_user_tags {
  user_id  Int
  tag_id   Int
  mt_tags  mt_tags  @relation(fields: [tag_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  mt_users mt_users @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  created_at              DateTime                @default(now()) @db.Timestamp(6)
  updated_at              DateTime                @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted              Boolean                 @default(false)

  @@id([user_id, tag_id])
}

model mt_users {
  id           Int            @id @default(autoincrement())
  email        String         @unique @db.VarChar(255)
  name         String         @db.VarChar(255)
  user_role    Int            @default(2)
  department   String
  company      String         @db.VarChar(255)
  password     String         @db.VarChar(255)
  created_at   DateTime       @default(now()) @db.Timestamp(6)
  updated_at   DateTime       @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted   Boolean        @default(false)
  mt_user_tags mt_user_tags[]

  @@index([email], map: "idx_users_email")
  @@index([user_role], map: "idx_users_role")
}

model tt_import_results {
  id                      Int                       @id @default(autoincrement())
  file_name               String?
  import_status           Int?                      @default(1)
  executor_name           String?                   @db.VarChar(255)
  import_type             Int?
  count                   Int?                      @default(0)
  message                 String?
  created_at              DateTime                  @default(now()) @db.Timestamp(6)
  updated_at              DateTime                  @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted              Boolean                   @default(false)
  @@index([import_status], map: "idx_import_results_status")
}

model tt_test_case_files {
  test_group_id Int
  tid           String        @db.VarChar(255)
  file_type     Int
  file_no       Int
  file_name     String?
  file_path     String?
  created_at    DateTime      @default(now()) @db.Timestamp(6)
  updated_at    DateTime      @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted    Boolean       @default(false)
  tt_test_cases tt_test_cases @relation(fields: [test_group_id, tid], references: [test_group_id, tid], onDelete: Cascade, onUpdate: NoAction)

  @@id([test_group_id, tid, file_type, file_no])
}

model tt_test_cases {
  test_group_id      Int
  tid                String               @db.VarChar(255)
  first_layer        String
  second_layer       String
  third_layer        String
  fourth_layer       String
  purpose            String
  request_id         String
  check_items        String
  test_procedure     String
  created_at         DateTime             @default(now()) @db.Timestamp(6)
  updated_at         DateTime             @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted         Boolean              @default(false)
  tt_test_case_files tt_test_case_files[]
  tt_test_groups     tt_test_groups       @relation(fields: [test_group_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tt_test_contents   tt_test_contents[]

  @@id([test_group_id, tid])
  @@index([test_group_id], map: "idx_test_cases_group")
}

model tt_test_contents {
  test_group_id    Int
  tid              String          @db.VarChar(255)
  test_no          Int
  variation        String?
  procedure        String?
  condition        String?
  expect           String?
  test_data        String?
  check_point      String?
  executor_id      Int?
  test_result      Int?
  ng_level         Int?
  ng_reason        String?
  ng_detail        String?
  judgment         String?
  memo             String?
  created_at       DateTime        @default(now()) @db.Timestamp(6)
  updated_at       DateTime        @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted       Boolean         @default(false)
  tt_test_cases    tt_test_cases   @relation(fields: [test_group_id, tid], references: [test_group_id, tid], onDelete: Cascade, onUpdate: NoAction)

  @@id([test_group_id, tid, test_no])
  @@index([test_group_id, tid], map: "idx_test_contents_case")
}

model tt_test_groups {
  id                 Int                  @id @default(autoincrement())
  oem                String               @db.VarChar(255)
  model              String               @db.VarChar(255)
  event              String               @db.VarChar(255)
  variation          String               @db.VarChar(255)
  destination        String               @db.VarChar(255)
  specs              String               @db.VarChar(255)
  test_startdate     DateTime             @db.Date
  test_enddate       DateTime             @db.Date
  ng_plan_count      Int
  created_at         DateTime             @default(now()) @db.Timestamp(6)
  updated_at         DateTime             @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted         Boolean              @default(false)
  tt_test_cases      tt_test_cases[]
  tt_test_group_tags tt_test_group_tags[]

  @@index([oem, model], map: "idx_test_groups_oem_model")
}

model tt_test_group_tags {
  test_group_id  Int
  tag_id         Int
  test_role      Int
  mt_tags        mt_tags        @relation(fields: [tag_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tt_test_groups tt_test_groups @relation(fields: [test_group_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  created_at     DateTime       @default(now()) @db.Timestamp(6)
  updated_at     DateTime       @default(now()) @updatedAt @db.Timestamp(6)
  is_deleted     Boolean        @default(false)

  @@id([test_group_id, tag_id])
  @@index([test_group_id], map: "idx_test_group_tags_group")
}
